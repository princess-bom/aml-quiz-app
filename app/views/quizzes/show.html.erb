<% content_for :page_title, "í€´ì¦ˆ" %>
<% content_for :back_button do %>
  <%= link_to quiz_selection_path, class: "mobile-header-back" do %>
    <span class="mobile-header-back-icon">â†</span>
  <% end %>
<% end %>

<!-- Quiz Navigation Header -->
<div class="quiz-nav">
  <div class="quiz-nav-header">
    <h2 class="quiz-nav-title">
      <%= @current_quiz&.subject || "ìê¸ˆì„¸íƒë°©ì§€ë²•" %> â€¢ 
      <%= @current_quiz&.quiz_type || "ê¸°ì´ˆ" %> â€¢ 
      <%= @current_quiz&.difficulty || "ì¤‘ê¸‰" %>
    </h2>
    <div class="quiz-nav-progress">
      ë¬¸ì œ <%= @quiz_session&.current_quiz_index || 3 %>/20 â€¢ 
      <%= (@quiz_session&.current_quiz_index || 3) * 5 %>% ì™„ë£Œ
    </div>
  </div>
  
  <div class="quiz-nav-progress-bar">
    <div class="quiz-nav-progress-fill" style="width: <%= (@quiz_session&.current_quiz_index || 3) * 5 %>%"></div>
  </div>
  
  <div class="quiz-nav-actions">
    <button class="quiz-nav-action active">
      <span>ğŸ”–</span>
      <span>ë¶ë§ˆí¬</span>
    </button>
    <button class="quiz-nav-action">
      <span>â±ï¸</span>
      <span>íƒ€ì´ë¨¸</span>
    </button>
  </div>
</div>

<!-- Question Content -->
<div class="card card--quiz">
  <div class="card-header">
    <h3 class="card-title">â“ ë¬¸ì œ <%= @quiz_session&.current_quiz_index || 3 %></h3>
  </div>
  
  <div class="card-content">
    <div class="quiz-question-text">
      <%= @current_quiz&.question || "ìê¸ˆì„¸íƒë°©ì§€ë²•ìƒ ê³ ê°í™•ì¸ ì˜ë¬´ë¥¼ ì´í–‰í•´ì•¼ í•˜ëŠ” ê±°ë˜ ê¸°ì¤€ ê¸ˆì•¡ì€?" %>
    </div>
    
    <!-- Answer Options -->
    <%= form_with url: answer_quiz_path(@quiz_session || 1), local: true, method: :post, class: "quiz-answer-options" do |form| %>
      
      <div class="quiz-answer-option" data-answer="A">
        <div class="quiz-answer-letter">A</div>
        <div class="quiz-answer-text">300ë§Œì› ì´ìƒ</div>
        <%= form.radio_button :selected_answer, "A", class: "sr-only" %>
      </div>
      
      <div class="quiz-answer-option" data-answer="B">
        <div class="quiz-answer-letter">B</div>
        <div class="quiz-answer-text">500ë§Œì› ì´ìƒ</div>
        <%= form.radio_button :selected_answer, "B", class: "sr-only" %>
      </div>
      
      <div class="quiz-answer-option selected" data-answer="C">
        <div class="quiz-answer-letter">C</div>
        <div class="quiz-answer-text">1000ë§Œì› ì´ìƒ</div>
        <%= form.radio_button :selected_answer, "C", class: "sr-only", checked: true %>
      </div>
      
      <div class="quiz-answer-option" data-answer="D">
        <div class="quiz-answer-letter">D</div>
        <div class="quiz-answer-text">3000ë§Œì› ì´ìƒ</div>
        <%= form.radio_button :selected_answer, "D", class: "sr-only" %>
      </div>
      
      <div class="quiz-answer-option" data-answer="E">
        <div class="quiz-answer-letter">E</div>
        <div class="quiz-answer-text">5000ë§Œì› ì´ìƒ</div>
        <%= form.radio_button :selected_answer, "E", class: "sr-only" %>
      </div>
      
      <!-- Submit Button -->
      <%= form.submit "ë‹µì•ˆ ì œì¶œ", class: "button button--submit-answer button--lg w-full", style: "margin-top: var(--space-6);" %>
      
    <% end %>
    
    <!-- Previous Question Button -->
    <% if (@quiz_session&.current_quiz_index || 3) > 1 %>
      <%= link_to previous_question_path(@quiz_session), class: "button button--outline w-full", style: "margin-top: var(--space-3);" do %>
        ì´ì „ ë¬¸ì œ
      <% end %>
    <% end %>
  </div>
</div>

<!-- Quiz Info -->
<div class="alert alert--info">
  <div class="alert-content">
    <h4 class="alert-title">í€´ì¦ˆ ì•ˆë‚´</h4>
    <ul class="alert-list" style="margin: 0; padding-left: var(--space-4);">
      <li>ğŸ”” ì œí•œì‹œê°„ ì—†ìŒ</li>
      <li>ğŸ“š ë¶ë§ˆí¬ ê°€ëŠ¥</li>
      <li>ğŸ” í•´ì„¤ ì œê³µ</li>
    </ul>
  </div>
</div>

<style>
.quiz-answer-option {
  cursor: pointer;
  transition: all 0.2s ease;
}

.quiz-answer-option:hover {
  border-color: var(--primary-300);
  background: var(--primary-50);
}

.quiz-answer-option.selected {
  border-color: var(--primary-500);
  background: var(--primary-50);
}

.quiz-answer-option.selected .quiz-answer-letter {
  background: var(--primary-500);
  color: white;
}

.alert-list {
  list-style: none;
}

.alert-list li {
  margin-bottom: var(--space-1);
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const answerOptions = document.querySelectorAll('.quiz-answer-option');
  const radioButtons = document.querySelectorAll('input[name="selected_answer"]');
  
  answerOptions.forEach(option => {
    option.addEventListener('click', function() {
      // Remove selected class from all options
      answerOptions.forEach(opt => opt.classList.remove('selected'));
      
      // Add selected class to clicked option
      this.classList.add('selected');
      
      // Update radio button
      const answer = this.dataset.answer;
      const radio = document.querySelector(`input[value="${answer}"]`);
      if (radio) {
        radio.checked = true;
      }
    });
  });
});
</script>