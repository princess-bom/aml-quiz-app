<% content_for :page_title, "í€´ì¦ˆ ì„ íƒ" %>
<% content_for :back_button do %>
  <%= link_to dashboard_path, class: "mobile-header-back" do %>
    <span class="mobile-header-back-icon">â†</span>
  <% end %>
<% end %>

<!-- Quiz System Header -->
<div class="dashboard-header text-center">
  <h1 class="dashboard-title">ğŸ¯ AML í€´ì¦ˆ ì‹œìŠ¤í…œ</h1>
  <p class="dashboard-subtitle">6ê³¼ëª© â€¢ 54ê°œ í€´ì¦ˆ<br>20ë¬¸ì œ ê°ê´€ì‹ í˜•íƒœ</p>
</div>

<!-- Recommended Quizzes -->
<div class="card">
  <div class="card-header">
    <h3 class="card-title">ğŸ“‹ ì¶”ì²œ í€´ì¦ˆ</h3>
  </div>
  <div class="card-content">
    
    <!-- Recommended Quiz 1 -->
    <%= link_to quiz_path(1), class: "subject-nav-card subject-nav-card--subject-1" do %>
      <div class="subject-nav-card-header">
        <div class="subject-nav-card-icon">ğŸ”µ</div>
        <div class="subject-nav-card-title">ìê¸ˆì„¸íƒë°©ì§€ë²•</div>
        <span class="quiz-nav-action">â–¶ï¸</span>
      </div>
      <div class="subject-nav-card-stats">
        <span>í‰ê·  82ì </span>
        <span>85% ì™„ë£Œ</span>
      </div>
      <div class="subject-nav-card-progress">
        <div class="subject-nav-card-progress-fill" style="width: 85%"></div>
      </div>
      <div class="badge-subjects-container" style="margin-top: var(--space-3);">
        <span class="badge badge--aml-global">ì¦ê²¨ì°¾ê¸°â­</span>
        <span class="badge badge--primary">ìµœê·¼ğŸ“…</span>
      </div>
    <% end %>

    <!-- Recommended Quiz 2 -->
    <%= link_to quiz_path(4), class: "subject-nav-card subject-nav-card--subject-4" do %>
      <div class="subject-nav-card-header">
        <div class="subject-nav-card-icon">ğŸŸ </div>
        <div class="subject-nav-card-title">ê³ ê°ê´€ë¦¬</div>
        <span class="quiz-nav-action">â–¶ï¸</span>
      </div>
      <div class="subject-nav-card-stats">
        <span>í‰ê·  65ì </span>
        <span>40% ì™„ë£Œ</span>
      </div>
      <div class="subject-nav-card-progress">
        <div class="subject-nav-card-progress-fill" style="width: 40%"></div>
      </div>
      <div class="badge-subjects-container" style="margin-top: var(--space-3);">
        <span class="badge badge--error">ê°œì„ í•„ìš”âš ï¸</span>
      </div>
    <% end %>

  </div>
</div>

<!-- All Subjects -->
<div class="card">
  <div class="card-header">
    <h3 class="card-title">ğŸ“š ì „ì²´ ê³¼ëª© ëª©ë¡</h3>
  </div>
  <div class="card-content">
    <div class="subject-nav">
      
      <!-- Subject 1: ìê¸ˆì„¸íƒë°©ì§€ë²• -->
      <%= link_to "#", class: "subject-nav-card subject-nav-card--subject-1", 
          data: { subject: "ìê¸ˆì„¸íƒë°©ì§€ë²•" } do %>
        <div class="subject-nav-card-header">
          <div class="subject-nav-card-icon">ğŸ”µ</div>
          <div class="subject-nav-card-title">ìê¸ˆì„¸íƒë°©ì§€ë²•</div>
          <span class="quiz-nav-action">â–¶ï¸</span>
        </div>
        <div class="subject-nav-card-stats">
          <span>í‰ê·  82ì </span>
          <span>85% ì™„ë£Œ</span>
        </div>
        <div class="subject-nav-card-progress">
          <div class="subject-nav-card-progress-fill" style="width: 85%"></div>
        </div>
      <% end %>

      <!-- Subject 2: ê³ ê°í™•ì¸ì œë„ -->
      <%= link_to "#", class: "subject-nav-card subject-nav-card--subject-2", 
          data: { subject: "ê³ ê°í™•ì¸ì œë„" } do %>
        <div class="subject-nav-card-header">
          <div class="subject-nav-card-icon">ğŸŸ£</div>
          <div class="subject-nav-card-title">ê³ ê°í™•ì¸ì œë„</div>
          <span class="quiz-nav-action">â–¶ï¸</span>
        </div>
        <div class="subject-nav-card-stats">
          <span>í‰ê·  78ì </span>
          <span>72% ì™„ë£Œ</span>
        </div>
        <div class="subject-nav-card-progress">
          <div class="subject-nav-card-progress-fill" style="width: 72%"></div>
        </div>
      <% end %>

      <!-- Subject 3: ì˜ì‹¬ê±°ë˜ ì‹ ê³  -->
      <%= link_to "#", class: "subject-nav-card subject-nav-card--subject-3", 
          data: { subject: "ì˜ì‹¬ê±°ë˜ ì‹ ê³ " } do %>
        <div class="subject-nav-card-header">
          <div class="subject-nav-card-icon">ğŸŸ¢</div>
          <div class="subject-nav-card-title">ì˜ì‹¬ê±°ë˜ ì‹ ê³ </div>
          <span class="quiz-nav-action">â–¶ï¸</span>
        </div>
        <div class="subject-nav-card-stats">
          <span>í‰ê·  92ì </span>
          <span>90% ì™„ë£Œ</span>
        </div>
        <div class="subject-nav-card-progress">
          <div class="subject-nav-card-progress-fill" style="width: 90%"></div>
        </div>
      <% end %>

      <!-- Subject 4: ê³ ê°ê´€ë¦¬ -->
      <%= link_to "#", class: "subject-nav-card subject-nav-card--subject-4", 
          data: { subject: "ê³ ê°ê´€ë¦¬" } do %>
        <div class="subject-nav-card-header">
          <div class="subject-nav-card-icon">ğŸŸ </div>
          <div class="subject-nav-card-title">ê³ ê°ê´€ë¦¬</div>
          <span class="quiz-nav-action">â–¶ï¸</span>
        </div>
        <div class="subject-nav-card-stats">
          <span>í‰ê·  65ì </span>
          <span>40% ì™„ë£Œ</span>
        </div>
        <div class="subject-nav-card-progress">
          <div class="subject-nav-card-progress-fill" style="width: 40%"></div>
        </div>
      <% end %>

      <!-- Subject 5: ë‚´ë¶€í†µì œ -->
      <%= link_to "#", class: "subject-nav-card subject-nav-card--subject-5", 
          data: { subject: "ë‚´ë¶€í†µì œ" } do %>
        <div class="subject-nav-card-header">
          <div class="subject-nav-card-icon">ğŸ”´</div>
          <div class="subject-nav-card-title">ë‚´ë¶€í†µì œ</div>
          <span class="quiz-nav-action">â–¶ï¸</span>
        </div>
        <div class="subject-nav-card-stats">
          <span>í‰ê·  45ì </span>
          <span>30% ì™„ë£Œ</span>
        </div>
        <div class="subject-nav-card-progress">
          <div class="subject-nav-card-progress-fill" style="width: 30%"></div>
        </div>
      <% end %>

      <!-- Subject 6: ê¸ˆìœµê°ë… -->
      <%= link_to "#", class: "subject-nav-card subject-nav-card--subject-6", 
          data: { subject: "ê¸ˆìœµê°ë…" } do %>
        <div class="subject-nav-card-header">
          <div class="subject-nav-card-icon">ğŸŸ¦</div>
          <div class="subject-nav-card-title">ê¸ˆìœµê°ë…</div>
          <span class="quiz-nav-action">â–¶ï¸</span>
        </div>
        <div class="subject-nav-card-stats">
          <span>í‰ê·  30ì </span>
          <span>20% ì™„ë£Œ</span>
        </div>
        <div class="subject-nav-card-progress">
          <div class="subject-nav-card-progress-fill" style="width: 20%"></div>
        </div>
      <% end %>

    </div>
  </div>
</div>

<!-- Search and Filter -->
<div class="form-group">
  <div class="search-form">
    <input type="text" class="search-form-input" placeholder="ê³¼ëª© ë˜ëŠ” í‚¤ì›Œë“œ ê²€ìƒ‰...">
    <button class="search-form-button" type="button">
      <span class="search-form-icon">ğŸ”</span>
    </button>
  </div>
</div>

<div class="button-group" style="margin-top: var(--space-4);">
  <button class="button button--outline">ğŸ” ê²€ìƒ‰</button>
  <button class="button button--outline">ğŸ¯ í•„í„°</button>
</div>

<!-- Subject Detail Modal Template (Hidden by default) -->
<div id="subject-modal" class="dialog-overlay">
  <div class="dialog dialog--large">
    <div class="dialog-header">
      <h2 class="dialog-title" id="modal-subject-title">ìê¸ˆì„¸íƒë°©ì§€ë²•</h2>
      <button class="dialog-close" type="button" onclick="closeSubjectModal()">
        <span class="dialog-close-icon">âœ•</span>
      </button>
    </div>
    
    <div class="dialog-content">
      <div class="dashboard-stats">
        <div class="dashboard-stat-card">
          <div class="dashboard-stat-title">í‰ê·  ì ìˆ˜</div>
          <div class="dashboard-stat-value" id="modal-avg-score">82ì </div>
        </div>
        <div class="dashboard-stat-card">
          <div class="dashboard-stat-title">ì™„ë£Œìœ¨</div>
          <div class="dashboard-stat-value" id="modal-completion">85%</div>
        </div>
        <div class="dashboard-stat-card">
          <div class="dashboard-stat-title">ìµœê·¼ í•™ìŠµ</div>
          <div class="dashboard-stat-value">2ì‹œê°„ ì „</div>
        </div>
      </div>

      <h3 class="card-title" style="margin: var(--space-6) 0 var(--space-4) 0;">ğŸ“ ìœ í˜•ë³„ í€´ì¦ˆ ì„ íƒ</h3>

      <!-- Basic Level -->
      <div class="collapsible">
        <div class="collapsible-trigger">
          <span class="collapsible-title">
            ğŸ’¡ ê¸°ì´ˆ (ì´ë¡  ì¤‘ì‹¬)
          </span>
          <span class="collapsible-icon">â–¼</span>
        </div>
        <div class="collapsible-content">
          <div class="collapsible-content-inner">
            <div class="button-group button-group--quiz-actions">
              <div class="quiz-level-item">
                <div class="badge badge--easy">ì´ˆê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">âœ… 85ì </div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <%= link_to "ì‹œì‘", "#", class: "button button--sm button--success" %>
              </div>
              <div class="quiz-level-item">
                <div class="badge badge--medium">ì¤‘ê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">âœ… 78ì </div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <%= link_to "ì‹œì‘", "#", class: "button button--sm button--success" %>
              </div>
              <div class="quiz-level-item">
                <div class="badge badge--hard">ê³ ê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">â–¶ï¸ ì‹œì‘</div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <%= link_to "ì‹œì‘", "#", class: "button button--sm button--primary" %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Applied Level -->
      <div class="collapsible">
        <div class="collapsible-trigger">
          <span class="collapsible-title">
            ğŸ”§ ì‘ìš© (ì‹¤ë¬´ ì¤‘ì‹¬)
          </span>
          <span class="collapsible-icon">â–¼</span>
        </div>
        <div class="collapsible-content">
          <div class="collapsible-content-inner">
            <div class="button-group button-group--quiz-actions">
              <div class="quiz-level-item">
                <div class="badge badge--easy">ì´ˆê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">âœ… 92ì </div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <%= link_to "ì‹œì‘", "#", class: "button button--sm button--success" %>
              </div>
              <div class="quiz-level-item">
                <div class="badge badge--medium">ì¤‘ê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">â–¶ï¸ ì‹œì‘</div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <%= link_to "ì‹œì‘", "#", class: "button button--sm button--primary" %>
              </div>
              <div class="quiz-level-item">
                <div class="badge badge--hard">ê³ ê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">ğŸ”’ ì ê¸ˆ</div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <button class="button button--sm button--secondary" disabled>ì ê¸ˆ</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Advanced Level -->
      <div class="collapsible">
        <div class="collapsible-trigger">
          <span class="collapsible-title">
            ğŸš€ ì‹¬í™” (ì¢…í•© ì‘ìš©)
          </span>
          <span class="collapsible-icon">â–¼</span>
        </div>
        <div class="collapsible-content">
          <div class="collapsible-content-inner">
            <div class="button-group button-group--quiz-actions">
              <div class="quiz-level-item">
                <div class="badge badge--easy">ì´ˆê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">â–¶ï¸ ì‹œì‘</div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <%= link_to "ì‹œì‘", "#", class: "button button--sm button--primary" %>
              </div>
              <div class="quiz-level-item">
                <div class="badge badge--medium">ì¤‘ê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">ğŸ”’ ì ê¸ˆ</div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <button class="button button--sm button--secondary" disabled>ì ê¸ˆ</button>
              </div>
              <div class="quiz-level-item">
                <div class="badge badge--hard">ê³ ê¸‰</div>
                <div class="dashboard-stat-value" style="font-size: var(--text-lg);">ğŸ”’ ì ê¸ˆ</div>
                <div class="dashboard-subtitle">20ë¬¸ì œ</div>
                <button class="button button--sm button--secondary" disabled>ì ê¸ˆ</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Performance Summary -->
      <div class="card" style="margin-top: var(--space-6);">
        <div class="card-header">
          <h3 class="card-title">ğŸ“Š ì„±ê³¼ ìš”ì•½</h3>
        </div>
        <div class="card-content">
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin-bottom: var(--space-2);">â€¢ ì™„ë£Œí•œ í€´ì¦ˆ: 5/9</li>
            <li style="margin-bottom: var(--space-2);">â€¢ í‰ê·  ì ìˆ˜: 82ì </li>
            <li style="margin-bottom: var(--space-2);">â€¢ ì·¨ì•½ ì˜ì—­: ì‹¬í™” ê³¼ì •</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.quiz-level-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-4);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  text-align: center;
  flex: 1;
}

.button-group--quiz-actions {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-4);
  width: 100%;
}

@media (max-width: 768px) {
  .button-group--quiz-actions {
    grid-template-columns: 1fr;
  }
}
</style>

<script>
function openSubjectModal(subjectName) {
  const modal = document.getElementById('subject-modal');
  const title = document.getElementById('modal-subject-title');
  title.textContent = subjectName;
  modal.classList.add('open');
}

function closeSubjectModal() {
  const modal = document.getElementById('subject-modal');
  modal.classList.remove('open');
}

// Add click handlers to subject cards
document.addEventListener('DOMContentLoaded', function() {
  const subjectCards = document.querySelectorAll('[data-subject]');
  subjectCards.forEach(card => {
    card.addEventListener('click', function(e) {
      e.preventDefault();
      const subjectName = this.dataset.subject;
      openSubjectModal(subjectName);
    });
  });
  
  // Close modal when clicking overlay
  document.getElementById('subject-modal').addEventListener('click', function(e) {
    if (e.target === this) {
      closeSubjectModal();
    }
  });
});
</script>