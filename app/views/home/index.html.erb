<% content_for :page_title, "홈" %>

<!-- Welcome Section -->
<div class="dashboard-header">
  <h1 class="dashboard-title">안녕하세요, <%= (current_user && current_user['name']) || '김민수' %>님!</h1>
  <p class="dashboard-subtitle">TPAC 시험 합격을 위해 노력하고 있어요</p>
</div>

<!-- Quick Stats -->
<div class="dashboard-stats">
  <div class="dashboard-stat-card">
    <div class="dashboard-stat-header">
      <span class="dashboard-stat-title">총 세션</span>
      <span class="dashboard-stat-icon">📚</span>
    </div>
    <div class="dashboard-stat-value"><%= @user_stats[:total_sessions] %>회</div>
    <% if @user_stats[:total_sessions] > 0 %>
      <div class="dashboard-stat-change dashboard-stat-change--positive">
        <span>📚 학습 진행 중</span>
      </div>
    <% else %>
      <div class="dashboard-stat-change">
        <span>시작해보세요!</span>
      </div>
    <% end %>
  </div>
  
  <div class="dashboard-stat-card">
    <div class="dashboard-stat-header">
      <span class="dashboard-stat-title">평균점수</span>
      <span class="dashboard-stat-icon">📊</span>
    </div>
    <div class="dashboard-stat-value"><%= @user_stats[:average_score].round %>점</div>
    <% if @user_stats[:average_score] >= 80 %>
      <div class="dashboard-stat-change dashboard-stat-change--positive">
        <span>🎉 우수한 성과</span>
      </div>
    <% elsif @user_stats[:average_score] >= 60 %>
      <div class="dashboard-stat-change">
        <span>👍 좋은 진전</span>
      </div>
    <% else %>
      <div class="dashboard-stat-change">
        <span>💪 화이팅!</span>
      </div>
    <% end %>
  </div>
</div>

<!-- Study Streak -->
<% if @user_stats[:study_streak] > 0 %>
  <div class="alert alert--streak-achievement">
    <div class="alert-content">
      <div class="alert-streak-emoji">
        <% if @user_stats[:study_streak] >= 7 %>⭐<% elsif @user_stats[:study_streak] >= 3 %>🔥<% else %>📚<% end %>
      </div>
      <div class="alert-streak-content">
        <h3 class="alert-title">연속 학습 <%= @user_stats[:study_streak] %>일 달성!</h3>
        <p class="alert-description">
          <% if @user_stats[:study_streak] >= 7 %>
            꾸준한 학습으로 실력이 향상되고 있어요! 🎉
          <% elsif @user_stats[:study_streak] >= 3 %>
            좋은 습관을 만들어가고 있네요! 💪
          <% else %>
            오늘도 학습을 시작해보세요! 📖
          <% end %>
        </p>
      </div>
    </div>
  </div>
<% else %>
  <div class="alert alert--info">
    <div class="alert-content">
      <div class="alert-streak-emoji">🚀</div>
      <div class="alert-streak-content">
        <h3 class="alert-title">학습을 시작해보세요!</h3>
        <p class="alert-description">꾸준한 학습으로 TPAC 시험에 합격하세요! 📚</p>
      </div>
    </div>
  </div>
<% end %>

<!-- Main CTA -->
<%= link_to quiz_selection_path, class: "button button--start-quiz button--lg w-full" do %>
  <span>▶️ 퀴즈 시작하기</span>
<% end %>

<!-- Overall Progress -->
<div class="card card--quiz">
  <div class="card-header">
    <h3 class="card-title">🎯 전체 진도율</h3>
  </div>
  <div class="card-content">
    <div class="quiz-nav-progress-bar">
      <div class="quiz-nav-progress-fill" style="width: 33%"></div>
    </div>
    <p class="dashboard-subtitle">18/54 퀴즈 완료</p>
  </div>
</div>

<!-- Recent Activity -->
<div class="dashboard-recent-activity">
  <div class="dashboard-activity-header">
    <h3 class="dashboard-activity-title">🕐 최근 활동</h3>
  </div>
  <div class="dashboard-activity-list">
    <div class="dashboard-activity-item">
      <div class="dashboard-activity-icon dashboard-activity-icon--quiz">📚</div>
      <div class="dashboard-activity-content">
        <div class="dashboard-activity-description">자금세탁방지법 85점</div>
        <div class="dashboard-activity-time">2시간 전</div>
      </div>
    </div>
    <div class="dashboard-activity-item">
      <div class="dashboard-activity-icon dashboard-activity-icon--score">✅</div>
      <div class="dashboard-activity-content">
        <div class="dashboard-activity-description">의심거래 신고 92점</div>
        <div class="dashboard-activity-time">1일 전</div>
      </div>
    </div>
    <div class="dashboard-activity-item">
      <div class="dashboard-activity-icon dashboard-activity-icon--quiz">📖</div>
      <div class="dashboard-activity-content">
        <div class="dashboard-activity-description">고객확인제도 78점</div>
        <div class="dashboard-activity-time">2일 전</div>
      </div>
    </div>
  </div>
</div>

<!-- Subject Progress -->
<div class="subject-nav">
  <div class="subject-nav-card subject-nav-card--subject-1">
    <div class="subject-nav-card-header">
      <div class="subject-nav-card-icon">🔵</div>
      <div class="subject-nav-card-title">자금세탁방지법</div>
    </div>
    <div class="subject-nav-card-stats">
      <span>평균 85점</span>
      <span>85% 완료</span>
    </div>
    <div class="subject-nav-card-progress">
      <div class="subject-nav-card-progress-fill" style="width: 85%"></div>
    </div>
  </div>
  
  <div class="subject-nav-card subject-nav-card--subject-3">
    <div class="subject-nav-card-header">
      <div class="subject-nav-card-icon">🟢</div>
      <div class="subject-nav-card-title">의심거래 신고</div>
    </div>
    <div class="subject-nav-card-stats">
      <span>평균 92점</span>
      <span>90% 완료</span>
    </div>
    <div class="subject-nav-card-progress">
      <div class="subject-nav-card-progress-fill" style="width: 90%"></div>
    </div>
  </div>
  
  <div class="subject-nav-card subject-nav-card--subject-2">
    <div class="subject-nav-card-header">
      <div class="subject-nav-card-icon">🟣</div>
      <div class="subject-nav-card-title">고객확인제도</div>
    </div>
    <div class="subject-nav-card-stats">
      <span>평균 78점</span>
      <span>72% 완료</span>
    </div>
    <div class="subject-nav-card-progress">
      <div class="subject-nav-card-progress-fill" style="width: 72%"></div>
    </div>
  </div>
</div>

<%= link_to quiz_selection_path, class: "button button--outline w-full" do %>
  전체 과목 보기
<% end %>

<!-- Quick Actions -->
<div class="dashboard-quick-actions">
  <%= link_to wrong_answers_path, class: "dashboard-quick-action" do %>
    <span class="dashboard-quick-action-icon">📝</span>
    <span>오답노트</span>
  <% end %>
  
  <%= link_to analytics_path, class: "dashboard-quick-action" do %>
    <span class="dashboard-quick-action-icon">📊</span>
    <span>학습분석</span>
  <% end %>
</div>

<!-- Daily Goal -->
<div class="card">
  <div class="card-header">
    <h3 class="card-title">🎯 오늘의 목표</h3>
  </div>
  <div class="card-content">
    <div class="dashboard-activity-description">학습 시간: 15분 / 20분 목표</div>
    <div class="quiz-nav-progress-bar">
      <div class="quiz-nav-progress-fill" style="width: 75%"></div>
    </div>
  </div>
</div>